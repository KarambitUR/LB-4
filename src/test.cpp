#include "../source.cpp"
#include <gtest/gtest.h>

unsigned int M1[2] =  {0x12345678, 0xFF00FF00};
unsigned int C1[2] =  {0xA12DA905, 0x4398D552};
unsigned int K1[4] =  {0xAABBCCDD, 0x33554477, 0x00000000, 0xFFFFFFFF};

unsigned int M2[4] =  {0xFFA2E417, 0x98D541C8, 0xFF3E7B4C, 0x13151719};
unsigned int C2[4] =  {0x90423F35, 0xF41D46C7, 0x3A06D9F2, 0x81823FEE};
unsigned int K2[4] =  {0xABACADAE, 0x98765421, 0xCDAEFBA5, 0xA3A4A5FF};

unsigned int M3[8] =  {0x56D7AB9C, 0x1FEB042A, 0xA5C862F3, 0x8D3912E5, 
                       0x0B7FED6A, 0xE2A10F87, 0x3C8B9165, 0xF9D26B40};
unsigned int C3[8] =  {0xE9652154, 0x707EC347, 0x73F6404B, 0xB1B8D003, 
                       0xB517314E, 0x433254A5, 0x07550EDB, 0xBA15AF63};
unsigned int K3[4] =  {0x5A78FBCD, 0x19E427A5, 0xACD6903F, 0x8F3B6E21};

unsigned int M4[16] = {0xA1B3CCEF, 0x7D8E9F22, 0x0F6A4E11, 0x5CB298F7, 
                       0x29D70163, 0xEFA35B46, 0x8BEC9D3C, 0x61F8DE92, 
                       0xD6F01A0A, 0x92C41F56, 0xB94E2387, 0xC2A569FE, 
                       0x4E65D0D9, 0xF7CB6CBB, 0x1748E4DC, 0x3A91B02E};
unsigned int C4[16] = {0xE15A0746, 0xFB66231A, 0xC9F24AA3, 0x7A825DDA, 
                       0xEE395F55, 0x95979FE7, 0x1454182A, 0xC5C66388, 
                       0x2C1D163D, 0xA385902A, 0xBB1C0BF2, 0x8C5E3C6A, 
                       0x8234A131, 0x9A5D3E14, 0xCB8B9AF8, 0xD3EA61EC};
unsigned int K4[4] =  {0x57B0FA91, 0x6A5C6D20, 0x1D9E8B3F, 0x3FC254E8};
 
TEST(Task1Test, Encryption) { 
    EXPECT_EQ(Task1(M1,  2, K1, true), "A12DA905 4398D552");
    EXPECT_EQ(Task1(M2,  4, K2, true), "90423F35 F41D46C7 3A06D9F2 81823FEE");
    EXPECT_EQ(Task1(M3,  8, K3, true), "E9652154 707EC347 73F6404B B1B8D003 B517314E 433254A5 07550EDB BA15AF63");
    EXPECT_EQ(Task1(M4, 16, K4, true), "E15A0746 FB66231A C9F24AA3 7A825DDA EE395F55 95979FE7 1454182A C5C66388 2C1D163D A385902A BB1C0BF2 8C5E3C6A 8234A131 9A5D3E14 CB8B9AF8 D3EA61EC");
}

TEST(Task1Test, Decryption) { 
    EXPECT_EQ(Task1(C1,  2, K1, false), "12345678 FF00FF00");
    EXPECT_EQ(Task1(C2,  4, K2, false), "FFA2E417 98D541C8 FF3E7B4C 13151719");
    EXPECT_EQ(Task1(C3,  8, K3, false), "56D7AB9C 1FEB042A A5C862F3 8D3912E5 0B7FED6A E2A10F87 3C8B9165 F9D26B40");
    EXPECT_EQ(Task1(C4, 16, K4, false), "A1B3CCEF 7D8E9F22 0F6A4E11 5CB298F7 29D70163 EFA35B46 8BEC9D3C 61F8DE92 D6F01A0A 92C41F56 B94E2387 C2A569FE 4E65D0D9 F7CB6CBB 1748E4DC 3A91B02E");
}
 
int main(int argc, char **argv) {
    testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}

